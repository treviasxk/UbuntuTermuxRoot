#!/system/bin/sh
cmd=$1
banner (){
    clear
    echo " ============= UBUNTU TERMUX ROOT ============="
    echo -e "\e[1m\e[32m ______  ___  ___ _    _ .   _   ___   _  _ _ _"
    echo "   ||   |__/ |___  \  /  |  /_\  |__    \/  |/ "
    echo "   ||   |  \ |___   \/   | /   \  __|  _/\_ |\_"
    echo -e "\e[0m\e[39m ______________________________________________"
    echo " REDES SOCIAIS:                       treviasxk"
    echo " VERSÃO:                              1.0.1.0"
    echo " LICENÇA:                             GPL-3.0"
    echo " =============================================="
}

export bin=/system/bin
export PATH=/usr/bin:/usr/sbin:/bin:/usr/local/bin:/usr/local/sbin:$PATH
export TERM=linux
export HOME=/root
export USER=root
export LOGNAME=root
unset LD_PRELOAD

suuninstall (){
  banner
  echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m DESINSTALANDO UBUNTU... \e[0m"
  mount -o rw,remount /data
  mount -o rw,remount /system/bin
  rm /system/bin/ubuntu 2> /dev/null
  rm /data/data/com.termux/files/usr/bin/ubuntu 2> /dev/null
  rm -rf /data/local/ubuntu 2> /dev/null
  echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m DESINSTALAÇÃO CONCLUÍDO! \e[0m"
  exit
}

uninstall (){
  banner
  echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m DESINSTALANDO UBUNTU... \e[0m"
  sudo mount -o rw,remount /data
  sudo mount -o rw,remount /system/bin
  sudo rm /system/bin/ubuntu 2> /dev/null
  sudo rm /data/data/com.termux/files/usr/bin/ubuntu 2> /dev/null
  sudo rm -rf /data/local/ubuntu 2> /dev/null
  echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m DESINSTALAÇÃO CONCLUÍDO! \e[0m"
  exit
}

case $cmd in
  "")
    #vazio
  ;;
  "-u")
    suuninstall
  ;;
  "--uninstall")
    suuninstall
  ;;
  *)
    echo -e "\e[30;48;5;82m STATUS \e[40;38;5;82m COMANDO INVÁLIDO! \e[0m"
    exit
  ;;
esac

if [ "$EUID" -ne 0 ]
then
  setenforce 0
  mount -o remount,suid /data
  mountpoint -q /data/local/ubuntu/dev
  mount -o bind /dev /data/local/ubuntu/dev
  mount -t devpts devpts /data/local/ubuntu/dev/pts
  mount -t proc proc /data/local/ubuntu/proc
  mount -t sysfs sysfs /data/local/ubuntu/sys
  mount -t tmpfs none /data/local/ubuntu/tmp
  chmod 666 /dev/null
  sysctl -w net.ipv4.ip_forward=1

  clear
  chroot /data/local/ubuntu /bin/login -f root
else
  sudo setenforce 0
  sudo mount -o remount,suid /data
  sudo mountpoint -q /data/local/ubuntu/dev
  sudo mount -o bind /dev /data/local/ubuntu/dev
  sudo mount -t devpts devpts /data/local/ubuntu/dev/pts
  sudo mount -t proc proc /data/local/ubuntu/proc
  sudo mount -t sysfs sysfs /data/local/ubuntu/sys
  sudo mount -t tmpfs none /data/local/ubuntu/tmp
  sudo chmod 666 /dev/null
  sudo sysctl -w net.ipv4.ip_forward=1

  clear
  sudo chroot /data/local/ubuntu /bin/login -f root
fi